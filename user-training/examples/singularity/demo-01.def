Bootstrap: localimage

From: ./demo-template.sif


%help

    Supermagic is a MPI sanity check - https://github.com/hpc/supermagic

#%setup


#%files


%labels

    Maintainer Jordi Blasco (hpcnow.com)

    Version v1.0


%environment

    LD_LIBRARY_PATH=/usr/lib/libibverbs:$LD_LIBRARY_PATH


%post

    echo "Installing Supermagic"
    git clone https://github.com/hpc/supermagic.git
    cd supermagic
    make MPICC=cc
    cp -p supermagic /usr/bin/

%runscript

    /usr/bin/supermagic

%test

    #/usr/local/bin/mpirun --allow-run-as-root /usr/bin/supermagic
    /usr/local/bin/mpirun /usr/bin/supermagic
